@model IEnumerable<XyTech.Models.tb_profit>

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<div class="card">
    <div class="card-body">
        <div class="table-responsive pt-3">
            @{
                var sortedProfit = Model.OrderByDescending(p => int.Parse(p.p_month.Substring(0, 4))).ThenByDescending(p => int.Parse(p.p_month.Substring(5)));
            }

            <table class="table table-bordered" id="dataTable">
                <thead>
                    <tr>
                        @if (Session["id"] != null && Session["usertype"].Equals("Investor"))
                        {
                            <th>
                                @Html.DisplayNameFor(model => model.tb_investor.i_id)
                            </th>
                        }
                        <th>
                            Year
                        </th>
                        <th>
                            Month
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.p_profit)
                        </th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in sortedProfit)
                    {
                        var year = int.Parse(item.p_month.Substring(0, 4));
                        var month = int.Parse(item.p_month.Substring(5));

                        <tr>
                            @if (Session["id"] != null && Session["usertype"].Equals("Investor"))
                            {
                                <td>
                                    @Html.DisplayFor(modelItem => item.tb_investor.i_id)
                                </td>
                            }
                            <td>
                                @year
                            </td>
                            <td>
                                @month
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.p_profit)
                            </td>
                        </tr>
                    }
                </tbody>
            </table>


        </div>
    </div>
</div>


@section Scripts {
    <script>
        $(document).ready(function () {
            jQuery('#dataTable').DataTable();
        });

        var inflowAmounts = document.querySelectorAll(".inflow-amount");
        inflowAmounts.forEach(function (element) {
            element.textContent = parseFloat(element.textContent).toFixed(2);
        });

        document.addEventListener("DOMContentLoaded", function () {
            var allOption = document.querySelector('#f_floor option[value="select"]');
            allOption.disabled = true;
        });
    </script>
}
