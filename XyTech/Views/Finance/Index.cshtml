@model IEnumerable<XyTech.Models.tb_finance>

<div class="row">
    <div class="col-md-12 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                @if (ViewBag.Message == "Transaction is successfully saved!")
                {
                    <div class="alert alert-success">
                        <strong>@ViewBag.Message</strong>
                        <button type="button" class="close" data-dismiss="alert">
                            <span class="mdi mdi-close"></span>
                        </button>
                    </div>
                }
                @if (ViewBag.Message == "Transaction is deleted.")
                {
                    <div class="alert alert-danger">
                        <strong>@ViewBag.Message</strong>
                        <button type="button" class="close" data-dismiss="alert">
                            <span class="mdi mdi-close"></span>
                        </button>
                    </div>
                }
            <div class="d-flex justify-content-between">
                <p class="card-title mb-0" style="font-size: x-large;">Finance</p>


                @*@Html.ActionLink("Summary", "Summary", "Finance", null, new { @class = "btn btn-primary btn-rounded" })*@

                @Html.ActionLink("New Transaction", "Create", null, new { @class = "btn btn-success btn-rounded" })
            </div>
                <br />

                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table id="dataTable" class="display expandable-table" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>
                                            Year
                                        </th>
                                        <th>
                                            Month
                                        </th>
                                        <th>
                                            Day
                                        </th>
                                        <th>
                                            Inflow
                                        </th>
                                        <th>
                                            Outflow
                                        </th>
                                        <th>
                                            Bank/Cash
                                        </th>
                                        <th>
                                            Details
                                        </th>
                                        <th>
                                            Floor ID
                                        </th>
                                        <th>
                                            Action
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in Model)
                                    {
                                        // Extract year, month, and day from f_date
                                        var year = item.f_date.Year;
                                        var month = item.f_date.Month;
                                        var day = item.f_date.Day;

                                        <tr>

                                            <td>
                                                @year
                                            </td>
                                            <td>
                                                @month
                                            </td>
                                            <td>
                                                @day
                                            </td>
                                            <td class="text-success">
                                                @if (item.f_transactiontype == "Inflow")
                                                {
                                                    <span class="inflow-amount">@item.f_transaction</span>
                                                }
                                            </td>
                                            <td class="text-danger">
                                                @if (item.f_transactiontype == "Outflow")
                                                {
                                                    <span class="inflow-amount">@item.f_transaction</span>
                                                }
                                            </td>

                                            <td>
                                                @Html.DisplayFor(modelItem => item.f_paymentmethod)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.f_desc)
                                            </td>

                                            @if (item.tb_floor?.fl_id == null)
                                            {
                                                <td>
                                                    General
                                                </td>
                                            }
                                            else
                                            {
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.tb_floor.fl_bname)
                                                </td>
                                            }

                                        <td>
                                            <a href="@Url.Action("Edit", new { id = item.f_id })" class="btn btn-link" title="edit">
                                                <i class="fa fa-edit text-primary"></i>
                                            </a>
                                            <a href="@Url.Action("Details", new { id = item.f_id })" class="btn btn-link" title="details">
                                                <i class="fa fa-info-circle text-info"></i>
                                            </a>
                                            <a href="@Url.Action("Delete", new { id = item.f_id })" class="btn btn-link" title="delete">
                                                <i class="fa fa-trash text-danger"></i>
                                            </a>

                                        </td>
                                        </tr>


                                    }
                                </tbody>


                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



@section Scripts {
    <script>
        $(document).ready(function () {
            jQuery('#dataTable').DataTable();
        });

        var inflowAmounts = document.querySelectorAll(".inflow-amount");
        inflowAmounts.forEach(function (element) {
            element.textContent = parseFloat(element.textContent).toFixed(2);
        });

        document.addEventListener("DOMContentLoaded", function () {
            var allOption = document.querySelector('#f_floor option[value="select"]');
            allOption.disabled = true;
        });
    </script>
}
